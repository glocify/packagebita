!function(e){"use strict";var t=function(e,t){var n=this.slice((t||e)+1||this.length);return this.length=0>e?this.length+e:e,this.push.apply(this,n)};e.fn.ajaxChosen=function(n,i,h){var a,s,c,o,r,u=e(this),l=!1,p=[],d=!1,g="/img/loading.gif";return 0===e("option",u).length&&u.append('<option value=""></option>'),h?u.chosen(h):u.chosen(),a=u.next(),c=e("input",a),o=c.get(0)?c.get(0).style.background:"","success"in n&&e.isFunction(n.success)&&(r=n.success),n.success=function(n,h,l){var g,w=n,f=p.length,v=!1,m=!1;if(d)return p.shift(),!1;if(f>1){if(e.each(p,function(e,i){return n.q===i?(e!==f-1?(v=!0,t.call(p,e)):(m=!0,p.length=0),!1):void 0}),v||!m)return!1}else if("undefined"==typeof p.shift())return!1;if("processItems"in i&&e.isFunction(i.processItems))w=i.processItems(n);else{if(!("results"in w))return console.log("Expected results key in data, but was not found. Options could not be built"),!1;w=w.results}g=e("option:selected",u).not(":empty").clone().attr("selected",!0),e("option",u).remove(),e('<option value=""/>').appendTo(u),a.hasClass("chzn-container-multi")&&g.appendTo(u),e.isArray(w)?e.each(w,function(t,n){e('<option value="'+n.id+'">'+n.text+"</option>").appendTo(u)}):e.each(w,function(t,n){e('<option value="'+t+'">'+n+"</option>").appendTo(u)}),u.trigger("liszt:updated"),s=e.Event("keyup"),s.which=39,c.val(n.q).trigger(s).get(0).style.background=o,e("> a span",a).text(u.attr("placeholder")||""),w.length>0?e(".no-results",a).hide():e(".no-results",a).show(),r&&r(n,h,l)},i||(i={}),"loadingImg"in i&&(g=i.loadingImg),e(".chzn-search > input, .chzn-choices .search-field input",a).bind("keyup",function(t){var h=e(this),s=h.val();return 9===t.which||13===t.which||16===t.which||17===t.which||18===t.which||19===t.which||20===t.which||27===t.which||33===t.which||34===t.which||35===t.which||36===t.which||37===t.which||38===t.which||39===t.which||40===t.which||44===t.which||45===t.which||144===t.which||145===t.which||91===t.which||93===t.which||224===t.which||t.which>=112&&t.which<=123?!1:"useAjax"in i&&e.isFunction(i.useAjax)&&!i.useAjax(t)?!1:0===e.trim(s).length?!1:(d=!0,e(".no-results",a).hide(),e.isArray(n.data)?("q"===n.data[n.data.length-1].name&&n.data.pop(),n.data=n.data.concat({name:"q",value:s})):("data"in n||(n.data={}),e.extend(n.data,{data:{q:s}})),"generateUrl"in i&&e.isFunction(i.generateUrl)&&(n.url=i.generateUrl(s)),c.get(0).style.background='transparent url("'+g+'") no-repeat right 3px',l&&clearTimeout(l),void(l=setTimeout(function(){p.push(s),d=!1,e.ajax(n)},700)))}),u}}(jQuery);